SET(DESTDIR $ENV{DESTDIR})

MESSAGE(STATUS "Installing R support package")

IF(WIN32)
	IF(DESTDIR)
		MESSAGE(STATUS "Installation with specified DESTDIR not (yet) supported on windows")
	ENDIF(DESTDIR)
	EXECUTE_PROCESS(
		COMMAND @R_EXECUTABLE@ CMD INSTALL -c -l @R_LIBDIR@ @CMAKE_CURRENT_SOURCE_DIR@/rkward
		WORKING_DIRECTORY @CMAKE_CURRENT_BINARY_DIR@
	)
ELSE(WIN32)
	EXECUTE_PROCESS(
		COMMAND mkdir -p @CMAKE_CURRENT_BINARY_DIR@/tmp ${DESTDIR}/@R_LIBDIR@
	)
	EXECUTE_PROCESS(
		COMMAND env TMPDIR=@CMAKE_CURRENT_BINARY_DIR@/tmp @R_EXECUTABLE@ CMD INSTALL -c -l ${DESTDIR}/@R_LIBDIR@ @CMAKE_CURRENT_SOURCE_DIR@/rkward
		WORKING_DIRECTORY @CMAKE_CURRENT_BINARY_DIR@
	)
ENDIF(WIN32)
